<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filtered Finance</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <!-- BTC Card -->
            <div class="col-12 col-md-4">
                <div class="card shadow-sm text-center bg-#f8f9fa">
                    <div class="card-body">
                        <h5 class="card-title">Bitcoin (BTC)</h5>
                        <p>
                            <% if (btcPrice !==null) { %>
                                <strong>$<%= btcPrice.toFixed(2) %></strong>
                                <% } else { %> unavailable <% } %>
                        </p>
                        <canvas id="btcChart" height="150"></canvas>
                        <p class="mt-5 shadow-sm text-center justify-content-center">
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Corrupti dignissimos ipsa minus officia fugit aperiam aliquid maiores, dolore ullam, voluptatum, nesciunt ea. Natus dolore blanditiis odio delectus laboriosam aperiam labore?
                        </p>
                    </div>
                </div>
            </div>
    
            <!-- XRP Card -->
            <div class="col-12 col-md-4">
                <div class="card shadow-sm text-center">
                    <div class="card-body">
                        <h5 class="card-title">Ripple (XRP)</h5>
                        <p>
                            <% if (xrpPrice !==null) { %>
                                <strong>$<%= xrpPrice.toFixed(2) %></strong>
                                <% } else { %> unavailable <% } %>
                        </p>
                        <canvas id="xrpChart" height="150"></canvas>
                        <p class="mt-5 shadow-sm text-center justify-content-center">
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Corrupti dignissimos ipsa minus officia fugit aperiam aliquid maiores, dolore ullam, voluptatum, nesciunt ea. Natus dolore blanditiis odio delectus laboriosam aperiam labore?
                        </p>
                    </div>
                </div>
            </div>
    
            <!-- SUI Card -->
            <div class="col-12 col-md-4">
                <div class="card shadow-sm text-center">
                    <div class="card-body">
                        <h5 class="card-title">SUI</h5>
                        <p>
                            <% if (suiPrice !==null) { %>
                                <strong>$<%= suiPrice.toFixed(2) %></strong>
                                <% } else { %> unavailable <% } %>
                        </p>
                        <canvas id="suiChart" height="150"></canvas>
                        <p class="mt-5 shadow-sm text-center justify-content-center">
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Corrupti dignissimos ipsa minus officia fugit aperiam aliquid maiores, dolore ullam, voluptatum, nesciunt ea. Natus dolore blanditiis odio delectus laboriosam aperiam labore?
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        (async function () {
            try {
                const endpoints = {
                    btc: "bitcoin",
                    xrp: "ripple",
                    sui: "sui"
                };

                for (const [key, id] of Object.entries(endpoints)) {
                    const res = await fetch(
                        `https://api.coingecko.com/api/v3/coins/${id}/market_chart?vs_currency=usd&days=1`
                    );
                    const json = await res.json();
                    const prices = json.prices || [];
                    const labels = prices.map(p => new Date(p[0]).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }));
                    const values = prices.map(p => p[1]);

                    new Chart(document.getElementById(`${key}Chart`), {
                        type: "line",
                        data: {
                            labels,
                            datasets: [{
                                label: `${id.toUpperCase()} (USD, 24h)`,
                                data: values,
                                borderWidth: 2,
                                borderColor: "rgba(0,200,0,0.8)",
                                fill: false,
                                tension: 0.25
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            scales: {
                                x: {
                                    ticks: { maxTicksLimit: 6, color: "#777" } // only a few time labels
                                },
                                y: {
                                    ticks: { callback: v => "$" + v.toLocaleString(), color: "#777" }
                                }
                            },
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    callbacks: {
                                        label: ctx => "$" + ctx.parsed.y.toFixed(2)
                                    }
                                }
                            }
                        }
                    });
                }
            } catch (e) {
                console.error("Chart load error:", e);
            }
        })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>

</body>
</html>